@{
    ViewData["Title"] = "SAGA 測試頁面";
}

<div class="text-center">
    <h1 class="display-4">SAGA Test Page.</h1>
    <div class="row mb-4">
        <div class="col">
            <button class="btn btn-primary" type="button" id="step_Full_SAGA">正常情況下，沒有任何異常的寫入</button>
        </div>
    </div>
    <br/><hr><br />
    <div class="row mb-4">
        <div class="col">
            <button class="btn btn-primary" type="button" id="step_1_SAGA">1. 第一步執行前中斷 (未執行)</button>
        </div>
    </div>
    <div class="row mb-4">
        <div class="col">
            <button class="btn btn-primary" type="button" id="step_2_SAGA">2. 第二步執行前中斷 (寫入 Log 結束)</button>
        </div>
    </div>
    <div class="row mb-4">
        <div class="col">
            <button class="btn btn-primary" type="button" id="step_3_SAGA">3. 第三步執行前中斷 (寫入 Log + 扣款 Balance 表 結束)</button>
        </div>
    </div>
    <div class="row mb-4">
        <div class="col">
            <button class="btn btn-primary" type="button" id="step_4_SAGA">4. 第四步執行前中斷(寫入 Log + 扣款 Balance 表 + 本地 Member 表 結束)</button>
        </div>
    </div>
    <div id="showinfo">...</div>
</div>


@section Scripts {
    <script>
        $(document).ready(function () {

            $("#step_Full_SAGA").click(function () {
                callStep_Full_SAGA_Simulator();
            });
            $("#step_1_SAGA").click(function () {
                callStep_1_SAGA_Simulator();
            });

            $("#step_2_SAGA").click(function () {
                callStep_2_SAGA_Simulator();
            });

            $("#step_3_SAGA").click(function () {
                callStep_3_SAGA_Simulator();
            });

            $("#step_4_SAGA").click(function () {
                callStep_4_SAGA_Simulator();
            });
        });

        // 正常情況下，沒有任何異常的寫入
        function callStep_Full_SAGA_Simulator() {
            $.ajax({
                url: '@Url.Action("FullSAGA", "Home")',
                type: 'GET',
                data: null,
                success: function (response) {
                    document.getElementById('showinfo').innerHTML = response;
                    ;
                },
                error: function () {
                }
            });
        }

        // 1. 第一步執行前中斷 (未執行)
        function callStep_1_SAGA_Simulator() {
            $.ajax({
                url: '@Url.Action("Step1SAGA", "Home")',
                type: 'GET',
                data: null,
                success: function (response) {
                    document.getElementById('showinfo').innerHTML = response;
;                },
                error: function () {
                }
            });
        }

        // 2. 第二步執行前中斷 (寫入 Log 結束)
        function callStep_2_SAGA_Simulator() {
            $.ajax({
                url: '@Url.Action("Step2SAGA", "Home")',
                type: 'GET',
                data: null,
                success: function (response) {
                    document.getElementById('showinfo').innerHTML = response;
                },
                error: function () {
                }
            });
        }

        // 3. 第三步執行前中斷 (寫入 Log + 扣款 Balance 表 結束)
        function callStep_3_SAGA_Simulator() {
            $.ajax({
                url: '@Url.Action("Step3SAGA", "Home")',
                type: 'GET',
                data: null,
                success: function (response) {
                    document.getElementById('showinfo').innerHTML = response;
                },
                error: function () {
                }
            });
        }

        // 4. 第四步執行前中斷(寫入 Log + 扣款 Balance 表 + 本地 Member 表 結束)
        function callStep_4_SAGA_Simulator() {
            $.ajax({
                url: '@Url.Action("Step4SAGA", "Home")',
                type: 'GET',
                data: null,
                success: function (response) {
                    document.getElementById('showinfo').innerHTML = response;
                },
                error: function () {
                }
            });
        }
        

    </script>
}
